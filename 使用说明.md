# 小红书自动发布工具 - 使用说明

## 目录
1. [功能概述](#功能概述)
2. [前置准备](#前置准备)
3. [飞书表格配置](#飞书表格配置)
4. [软件配置](#软件配置)
5. [发布操作](#发布操作)
6. [常见问题](#常见问题)

---

## 功能概述

本工具支持从飞书多维表格读取笔记内容，自动发布到小红书平台。

### 主要功能
- ✅ 支持比特浏览器多账号同时发布
- ✅ 支持谷歌浏览器单账号发布
- ✅ 支持飞书图片自动下载
- ✅ 支持文字配图（AI生成封面）
- ✅ 发布后自动更新飞书状态
- ✅ 支持多窗口对应不同飞书表格

### 图片来源选项
| 选项 | 说明 |
|------|------|
| 飞书图片 | 从飞书表格的"小红书封面"字段下载图片 |
| 文字配图 | 使用小红书的AI文字配图功能自动生成封面 |
| 本地合成图片 | 从本地图片目录读取（需配置图片目录） |

---

## 前置准备

### 1. 安装比特浏览器（多账号发布）
- 下载地址：https://www.bitbrowser.cn/
- 创建多个浏览器窗口，每个窗口登录一个小红书账号
- 确保比特浏览器已启动

### 2. 或使用谷歌浏览器（单账号发布）
- 首次使用需要手动登录小红书
- 登录状态会自动保存

### 3. 创建飞书应用
1. 访问 [飞书开放平台](https://open.feishu.cn/)
2. 创建企业自建应用
3. 获取 App ID 和 App Secret
4. 添加权限：
   - `bitable:app` - 多维表格权限
   - `drive:drive` - 云文档权限（下载图片需要）

---

## 飞书表格配置

### 表格字段要求

你的飞书多维表格需要包含以下字段：

| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| 小红书标题 | 文本 | ✅ | 笔记标题（最多20字，超出自动截断） |
| 小红书文案 | 文本 | ✅ | 笔记正文内容，支持 #话题 格式 |
| 小红书封面 | 附件 | ❌ | 封面图片（可多张），如为空则使用文字配图 |
| 状态 | 单选 | ✅ | 选项：待发布、已发布、发布失败 |
| 商品ID | 文本 | ❌ | 关联商品（可选） |

### 获取表格ID

飞书多维表格有两个ID：

1. **Base ID（多维表格ID）**
   - 打开飞书表格，查看URL
   - 格式：`https://xxx.feishu.cn/base/GGh2bW3Q2aHpi1shiVqcAlhmnMd`
   - `GGh2bW3Q2aHpi1shiVqcAlhmnMd` 就是 Base ID

2. **Data Table ID（数据表ID）**
   - 在表格URL中找到 `table=tblXXXXX` 部分
   - 或者在"系统设置"中测试连接时会显示
   - 格式：`tblLMlVq9PcwZwiU`

### 表格权限设置
1. 打开飞书表格
2. 点击右上角"分享"
3. 添加你创建的飞书应用
4. 授予"可编辑"权限

---

## 软件配置

### 步骤1：配置飞书连接

1. 打开软件，点击"系统设置"标签
2. 填写飞书配置：
   - **App ID**：飞书应用的 App ID
   - **App Secret**：飞书应用的 App Secret
   - **表格 ID**：飞书多维表格的 Base ID
3. 点击"测试连接"验证配置

### 步骤2：选择浏览器类型

在"系统设置"中选择：
- **比特浏览器**：支持多账号同时发布
- **谷歌浏览器**：单账号发布

### 步骤3：选择图片来源

- **飞书图片**：从表格附件下载（推荐）
- **文字配图**：使用小红书AI生成封面
- **本地合成图片**：需要配置本地图片目录

### 步骤4：配置窗口-表格映射（比特浏览器）

如果使用比特浏览器多账号发布：

1. 点击"刷新窗口列表"获取比特浏览器窗口
2. 为每个窗口配置对应的飞书表格：
   - 点击窗口旁边的"添加"按钮
   - 填写 **Base ID**（多维表格ID）
   - 填写 **数据表ID**（tbl开头的ID）
3. 点击"保存配置"

> 💡 每个窗口可以对应不同的飞书表格，实现多账号发布不同内容

---

## 发布操作

### 步骤1：加载笔记

1. 切换到"多账号发布"标签
2. 点击"刷新笔记"按钮
3. 系统会从飞书表格加载所有"待发布"状态的笔记

### 步骤2：选择要发布的笔记

- 勾选要发布的窗口（账号）
- 使用"全选"快速选择所有窗口
- 使用"清空笔记"清除已加载的笔记

### 步骤3：开始发布

1. 点击"开始发布"按钮
2. 系统会自动：
   - 打开浏览器窗口
   - 上传图片或使用文字配图
   - 填写标题和正文
   - 点击发布按钮
   - 更新飞书表格状态为"已发布"

### 步骤4：查看发布结果

- 发布过程中可以在控制台查看日志
- 发布完成后，飞书表格中的状态会自动更新

---

## 常见问题

### Q1: 标题被截断了怎么办？
小红书标题限制20个字符。系统会智能处理：
- 纯文字不超过20字：保留完整标题（包括emoji）
- 纯文字超过20字：截断到20字

### Q2: 飞书图片为空怎么办？
如果飞书表格中没有上传封面图片，系统会自动切换到"文字配图"模式，使用小红书的AI功能生成封面。

### Q3: 发布后状态没有更新？
检查以下几点：
1. 飞书应用是否有表格编辑权限
2. 表格中是否有"状态"字段
3. 状态字段是否为单选类型

### Q4: 比特浏览器窗口不显示？
1. 确保比特浏览器已启动
2. 点击"刷新窗口列表"
3. 检查比特浏览器API是否正常（默认端口54345）

### Q5: 如何添加话题标签？
在飞书表格的"小红书文案"字段中使用 `#话题名` 格式，系统会自动识别并选择对应话题。

示例：
```
这是正文内容 #小红书 #分享日常 #好物推荐
```

---

## 快捷操作

| 操作 | 说明 |
|------|------|
| 刷新笔记 | 重新从飞书加载待发布笔记 |
| 全选 | 选择所有窗口 |
| 清空笔记 | 清除当前加载的笔记列表 |
| 开始发布 | 开始自动发布选中的笔记 |
| 停止发布 | 中断当前发布任务 |

---

## 启动方式

### 方式1：使用批处理文件
双击 `启动应用.bat` 文件

### 方式2：命令行启动
```bash
npm run build
npm start
```

---

## 技术支持

如遇问题，请检查控制台日志输出，通常会显示详细的错误信息。
